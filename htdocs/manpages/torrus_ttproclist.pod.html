<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>ttproclist - Process a template with a nodelist</title>
<link rel="stylesheet" href="../torrusdoc.css" type="text/css" />
<link rev="made" href="mailto:gerrit@familiehaase.de" />
</head>

<body>

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->
<!--

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#options">OPTIONS</a></li>
	<li><a href="#examples">EXAMPLES</a></li>
	<li><a href="#notes">NOTES</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#author">AUTHOR</a></li>
</ul>
-->
<!-- INDEX END -->

<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>ttproclist - Process a template with a nodelist</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<p><strong>torrus ttproclist</strong> --tmpl=<em>TFILE</em> --out=<em>OFILE</em>
--nodes=<em>NFILE</em> [<em>options...</em>]</p>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>This command takes a Template-Toolkit template and a list of nodes
(usually SNMP devices) as input. The output file is a result of
template substitution, according to the specified options.
Command-line options <strong>--tmpl</strong>, <strong>--out</strong> and <strong>--nodes</strong> are mandatory.</p>
<p>This utility can be used to generate the discovery instructions XML out of
a predefined template and a dynamically generated list of devices.
Alternatively, it can produce Torrus XML configuration for a given list
of objects, etc.</p>
<p>The following variables are predefined when the template is processed:</p>
<ul>
<li><strong><a name="item_nodes"><code>nodes</code></a></strong><br />
</li>
Hash array of nodes. Hash keys are the node names. Values are symbolic
names. If symbolic names are not defined, values are the same as keys.
<p></p>
<li><strong><a name="item_param"><code>param</code></a></strong><br />
</li>
Hash array of command-line parameters given in <strong>--param</strong> option.
<p></p>
<li><strong><a name="item_nodesfile_2c_creator"><code>nodesfile</code>, <code>creator</code></a></strong><br />
</li>
Informative variables. They can be used to produce the creation
note in the resulting files. <code>nodesfile</code> returns the file name of nodes,
and <code>creator</code> returns a detailed information how the file was generated,
with timestamp and command line options.
<p></p></ul>
<p>
</p>
<hr />
<h1><a name="options">OPTIONS</a></h1>
<dl>
<dt><strong><a name="item__2d_2dtmpl_3dtfile"><strong>--tmpl</strong>=<em>TFILE</em></a></strong><br />
</dt>
<dd>
The file name of the input template. Relative names are looked in
the current directory and in <em>/usr/local/etc/torrus/templates</em>. The file name may also be
an absolute path.
</dd>
<p></p>
<dt><strong><a name="item__2d_2dout_3dofile"><strong>--out</strong>=<em>OFILE</em></a></strong><br />
</dt>
<dd>
Output file name. If no absolute path given, the file is written in the current
directory.
</dd>
<p></p>
<dt><strong><a name="item__2d_2dnodes_3dnfile"><strong>--nodes</strong>=<em>NFILE</em></a></strong><br />
</dt>
<dd>
The name of the nodes list. Nodes should be separated by space or tab
character or newline. Additional information, referred to as symbolic name,
can be supplied after a colon, of the form NODENAME:SYMBOLICNAME.
</dd>
<p></p>
<dt><strong><a name="item__2d_2dparam_3dname_3avalue_2cname_3avalue_2e_2e_2e"><strong>--param</strong>=<em>NAME:VALUE,NAME:VALUE...</em></a></strong><br />
</dt>
<dd>
List of optional parameters that may be used in the template.
</dd>
<p></p></dl>
<p>
</p>
<hr />
<h1><a name="examples">EXAMPLES</a></h1>
<p>The following example gerenates <code>devdiscover</code> input file from a template.
The template is as follows:</p>
<pre>
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF8&quot;?&gt;
 &lt;snmp-discovery&gt;
 &gt;&gt;&gt; usual DDX parameters here, like SNMP community and data-dir
  &lt;param name=&quot;snmp-community&quot; value=&quot;private&quot;/&gt;
  &lt;param...
 &gt;&gt;&gt; This loop generates per-host entries
  [% FOREACH n = nodes.keys.sort %]
  &lt;host&gt;
    &lt;param name=&quot;snmp-host&quot; value=&quot;[% n %]&quot;/&gt;
    &lt;param name=&quot;output-file&quot; value=&quot;nodes/[% n %].xml&quot;/&gt;
  &lt;/host&gt;
  [% END %]
 &gt;&gt;&gt; Generate the bundle file, so that you need only one
 &gt;&gt;&gt; entry in torrus-site-config.pl
  &lt;param name=&quot;output-bundle&quot; value=&quot;[% param.BUNDLE %].xml&quot;/&gt;
 &lt;/snmp-discovery&gt;</pre>
<p>The following command would generate <em>MY.ddx</em> from template file <em>MY.ddtmpl</em>
as described above. The file <em>MY.nodes</em> is a list of SNMP devices, one per
line. Then <code>devdiscover</code> is launched with <em>MY.ddx</em> as input. Note also the
short form of the command line wrapper.</p>
<pre>
 torrus ttproclist --tmpl=MY.ddtmpl \
   --nodes=MY.nodes \
   --out=/usr/local/etc/torrus/discovery/MY.ddx \
   --param=BUNDLE:MYNODES</pre>
<pre>
 torrus dd --in=MY.ddx --verbose</pre>
<p>In addition, you may put some common parameters in Template BLOCK
statement in a separate file, and INCLUDE it in your templates. See the
Template-Toolkit documentation for more detail.</p>
<p>
</p>
<hr />
<h1><a name="notes">NOTES</a></h1>
<p>See more documentation at Torrus home page: <a href="http://torrus.org">http://torrus.org</a></p>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p>Template-Toolkit documentation: <a href="http://template-toolkit.org/">http://template-toolkit.org/</a></p>
<p><em>torrus(1)</em>, <em>torrus_devdiscover(1)</em></p>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Stanislav Sinyagin &lt;<a href="mailto:ssinyagin@yahoo.com">ssinyagin@yahoo.com</a>&gt;</p>

</body>

</html>
