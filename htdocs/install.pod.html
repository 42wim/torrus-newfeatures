<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Torrus Installation Instructions</title>
<link rel="stylesheet" href="torrusdoc.css" type="text/css" />
<link rev="made" href="mailto:gerrit@familiehaase.de" />
</head>

<body>

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#torrus_installation_instructions">Torrus Installation Instructions</a></li>
	<ul>

		<li><a href="#required_software">Required Software</a></li>
		<li><a href="#recommended_software">Recommended Software</a></li>
		<li><a href="#installation_procedure">Installation Procedure</a></li>
		<li><a href="#torrus_directory_layout">Torrus directory layout</a></li>
		<li><a href="#configuring_torrus">Configuring Torrus</a></li>
		<li><a href="#site_configuration_options">Site configuration options</a></li>
		<li><a href="#apache_http_server_configuration">Apache HTTP server configuration</a></li>
		<li><a href="#access_control_lists">Access Control Lists</a></li>
		<li><a href="#cron_job">Cron Job</a></li>
		<li><a href="#startup_script">Startup script</a></li>
		<li><a href="#upgrade_procedure">Upgrade Procedure</a></li>
		<li><a href="#planning_the_disk_space">Planning the disk space</a></li>
		<li><a href="#network_performance_tuning">Network performance tuning</a></li>
	</ul>

	<li><a href="#author">Author</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="torrus_installation_instructions">Torrus Installation Instructions</a></h1>
<p>
</p>
<h2><a name="required_software">Required Software</a></h2>
<ul>
<li><strong><a name="item_operating_system">Operating System</a></strong><br />
</li>
Any UNIX-like operation system where the required components are working.
The author's primary development platform is Cygwin
&lt;<a href="http://www.cygwin.com">http://www.cygwin.com</a>&gt;,
and the primary testing environments are Sun Solaris/SPARC and FreeBSD.
<p>Note to <strong>VmWare</strong> users: as recommended by Gord Philpott, Linux kernel for
guest machine needs to be compiled with the following feature enabled:
<code>Character devices ---&gt; Enhanced Real Time Clock Support</code>.
For other guest operating systems (e.g. FreeBSD), in order to let the
Torrus collector and monitor run properly, you need to add the following
lines to your <em>torrus-siteconfig.pl</em>:</p>
<pre>
  $Torrus::Scheduler::maxSleepTime = 15;
  $Torrus::Scheduler::ignoreClockSkew = 1;</pre>
<p># <strong>Debian</strong> package is maintained by Jurij Smakov and is available at
# &lt;<a href="http://pkg-torrus.alioth.debian.org">http://pkg-torrus.alioth.debian.org</a>&gt;.</p>
<p></p>
<li><strong><a name="item_perl">Perl</a></strong><br />
</li>
Perl version <code>5.8.1</code> or higher is required. <strong>Version <code>5.8.0</code> is not
recommended</strong> because of memory access bugs and unpredictable behaviour.
Perl interpreter should be in PATH environment variable when
running <code>./configure</code>, otherwise use
<pre>
  ./configure PERL=/path/to/perl</pre>
<p>Torrus also supports Perl multithreading in Device Discovery engine and
in the Collector. Minimum requirements are as follows: Perl version 5.8.8
or higher, <code>threads</code> module version 1.41 or higher, <code>threads::shared</code> module
version 1.03 or higher. Older versions had bugs that were leading to
severe memory leaks and instability. After installing Perl 5.8.8,
you need to upgrade the <code>threads</code> and <code>threads::shared</code> modules manually
from CPAN. If any of the requirements is not met, the installer will
automatically disable the threads support in Torrus.</p>
<p></p>
<li><strong><a name="item_rrdtool">RRDtool</a></strong><br />
</li>
Round Robin Database Tool is available at:
&lt;<a href="http://ee-staff.ethz.ch/~oetiker/webtools/rrdtool/">http://ee-staff.ethz.ch/~oetiker/webtools/rrdtool/</a>&gt;.
Both stable version <code>1.0.x</code> and the development version <code>1.1.x</code>
are supported.
<p>As of this writing, rrdtool version <code>1.1.x</code> is still in its development
stage, but it is quite ready for using in production environments.
There's a small glitch in legend text alignment, and it will
hopefully be fixed.</p>
<p></p>
<li><strong><a name="item_libxml2">libxml2</a></strong><br />
</li>
libxml2 is the XML parser library from Gnome
project &lt;<a href="http://www.gnome.org">http://www.gnome.org</a>&gt;,
available as a standalone package.
Versions <code>2.4.23</code> and above were tested.
<p></p>
<li><strong><a name="item_berkeley_db_version_4_2e2_2e52_or_later">Berkeley DB version 4.2.52 or later</a></strong><br />
</li>
There are two distinct packages with slightly conflicting names:
The Berkeley DB from Sleepycat Software &lt;<a href="http://www.sleepycat.com">http://www.sleepycat.com</a>&gt;,
and <code>BerkeleyDB</code> Perl module available from CPAN. We will always refer
the latter as <em>BerkeleyDB Perl module</em>.
<p>The Berkeley DB database engine is used for all data storage.
Versions <code>4.2.52</code> and above are recommended.
Older versions of Berkeley DB had problems with database integrity
in concurrent usage. By default, it installs
into <em>/usr/local/BerkeleyDB.4.2/</em>.</p>
<p>Unfortunately, the BerkeleyDB Perl module cannot find the include and
library files in that directory. Thus either configure Berkeley DB
with the option <code>--prefix=/usr/local</code>, or you need to edit
<em>config.in</em> in BerkeleyDB Perl module distribution.</p>
<p></p>
<li><strong><a name="item_http_server">HTTP Server</a></strong><br />
</li>
Torrus requires Apache HTTP server (&lt;<a href="http://httpd.apache.org">http://httpd.apache.org</a>&gt;)
and mod_perl (&lt;<a href="http://perl.apache.org">http://perl.apache.org</a>&gt;).
<p>Apache version 1.3 and mod_perl version 1.0 are supported by ApacheHandler.</p>
<p>Apache version 2.0 and mod_perl 2.0 are supported by Apache2Handler.
Minimum supported mod_perl 2.0 version is <strong>2.0.0</strong>. The handler also requires
<code>libapreq2</code> library, see the note below.</p>
<p>See <em>Torrus Web Interface Reference</em> for details on mod_perl configuration.</p>
<p></p>
<li><strong><a name="item_perl_modules">Perl Modules</a></strong><br />
</li>
The Perl modules required are listed below. They are all available at
CPAN &lt;<a href="http://www.cpan.org">http://www.cpan.org</a>&gt;.
Some of them require other modules to be installed.
You can install all required modules with the following command,
executed from within the distribution directory:
<pre>
  perl -I `pwd`/setup_tools -MCPAN -e 'install Bundle::Torrus'</pre>
<ul>
<li><strong><a name="item_xml_3a_3alibxml">XML::LibXML</a></strong><br />
</li>
This is a Perl interface for libxml2, providing DOM standards compliant
interface. It is recommended that you use version <code>1.54_3</code> or higher.
<p></p>
<li><strong><a name="item_berkeleydb_perl_module">BerkeleyDB perl module</a></strong><br />
</li>
Perl interface to the database software.
Version <code>0.19</code> or higher is required.
<p></p>
<li><strong><a name="item_template_2dtoolkit">Template-Toolkit</a></strong><br />
</li>
This is a powerful set of tools for text template processing.
Torrus uses it for HTML files output.
See also the project homepage: &lt;<a href="http://www.template-toolkit.org">http://www.template-toolkit.org</a>&gt;
<p></p>
<li><strong><a name="item_proc_3a_3adaemon">Proc::Daemon</a></strong><br />
</li>
Daemon invocation routines.
<p></p>
<li><strong><a name="item_net_3a_3asnmp">Net::SNMP</a></strong><br />
</li>
SNMP queries and traps interface. Version <code>4.0.3</code> or higher is required.
<p></p>
<li><strong><a name="item_uri_3a_3aescape">URI::Escape</a></strong><br />
</li>
Escape and unescape unsafe characters
<p></p>
<li><strong><a name="item_apache">Apache (mod_perl version 1.0)</a></strong><br />
</li>
Mod_perl is a Perl runtime environment integrated into Apache HTTP server.
<p></p>
<li><strong><a name="item_apache_3a_3asession">Apache::Session</a></strong><br />
</li>
User session tracking helper
<p></p>
<li><strong><a name="item_date_3a_3aparse_and_date_3a_3aformat">Date::Parse and Date::Format</a></strong><br />
</li>
Module for parsing the user input for date and time.
<p></p></ul>
<li><strong><a name="item_libapreq2_perl_library"><code>libapreq2</code> Perl library</a></strong><br />
</li>
Apache 2.0 handler requires an additional Perl library, <code>libapreq2</code>.
It is available from CPAN &lt;<a href="http://search.cpan.org/">http://search.cpan.org/</a>&gt;, and currently
only in development version. You need to download and install it manually
in order for Apache2Handler to work. Minimum version required: libapreq2-2.05.
<p></p>
<li><strong><a name="item_http_browser_requirements">HTTP Browser requirements</a></strong><br />
</li>
The HTTP browser must be compatible with <em>HTML 4.01 Strict</em> and <em>CSS2</em>
specifications. The tests were made with the following browsers:
IE 5.5, Opera 6.12B1/Solaris, Opera 7.03/Win2K, Netscape 7.02.
<p></p></ul>
<p>
</p>
<h2><a name="recommended_software">Recommended Software</a></h2>
<ul>
<li><strong><a name="item_xml_3a_3axupdate_3a_3alibxml_by_petr_pajas"><code>XML::XUpdate::LibXML</code> by Petr Pajas</a></strong><br />
</li>
This Perl module implements XUpdate specification
&lt;<a href="http://www.xmldb.org/xupdate/">http://www.xmldb.org/xupdate/</a>&gt;. See Torrus User Guide for details.
<p></p>
<li><strong><a name="item_xsh_by_petr_pajas">XSH by Petr Pajas</a></strong><br />
</li>
Available at &lt;<a href="http://xsh.sourceforge.net">http://xsh.sourceforge.net</a>&gt;.
This is a shell wrapper for a set of utilities for XML extraction, browsing,
and editing.
<p></p>
<li><strong><a name="item_libxslt_from_gnome_project">libxslt from Gnome project</a></strong><br />
</li>
<code>libxslt</code> is the XSLT stranslation library from Gnome
project &lt;<a href="http://www.gnome.org">http://www.gnome.org</a>&gt;, available as a standalone package.
It includes a binary executable, <code>xsltproc</code>. See Torrus User Guide for
examples of its usage.
<p></p></ul>
<p>
</p>
<h2><a name="installation_procedure">Installation Procedure</a></h2>
<p>Create the group <code>torrus</code> and a user <code>torrus</code>. The user should be a member of
this group.</p>
<p>Add your Apache daemon user to the group <code>torrus</code>.
Other users that will run any of Torrus processes must be included in
this group.</p>
<p>For example, in Solaris (you may need to specify the GID and UID numbers
according to your local administration policy):</p>
<pre>
  groupadd torrus
  useradd -c 'Torrus Daemon' -d /usr/local/torrus -g torrus torrus
  usermod -G www,torrus www</pre>
<p>Further installation process is mostly as usual:</p>
<pre>
  ./configure
  make
  make install</pre>
<p>The default directory layout is described below. Should you need to change it,
there is a number of variables and configuration options that you may use
as <code>./configure</code> arguments. See <code>./configure --help</code> for details.
Alternatively you can utilize the script <code>./setup_tools/configure_fhs</code>,
which is designed to provide an FHS compliant setup. The script is equivalent
to executing</p>
<pre>
  ./configure \
   --prefix=/opt \
   --mandir=/opt/share/man \
   pkghome=/opt/torrus \
   sitedir=/etc/opt/torrus</pre>
<p>Do not try to change any paths by supplying them as <code>make</code> variables,
this would most probably break the installation. The only <code>make</code> variable
that is supported is <code>DESTDIR</code>. It may be used for preparing the package for
further distribution. For example, the following command would install
all Torrus files as if <em>/tmp/stage</em> were the root of the filesystem:</p>
<pre>
  make DESTDIR=/tmp/stage install</pre>
<p>The presence of prerequisite Perl modules is checked during the execution
of <code>./configure</code>. You can disable this by giving <em>--enable-pkgonly</em> option.</p>
<p>The installer sets up the site configuration files, but only if
they don't already exist.</p>
<p>Plugin modules should be installed separately, after the Torrus software is
successfully installed. For each plugin, unpack the plugin distribution archive
to some directory, and execute</p>
<pre>
  torrus install_plugin &lt;UNPACKED_PLUGIN_DIR&gt;</pre>
<p>A number of directories is set up by default under the path <code>/var</code>,
and they must be writable by all Torrus processes, including the
Apache web server.</p>
<p>You can control these directories' access rights by setting the following
environment variables: <em>var_user</em>, <em>var_group</em>, <em>var_mode</em>, like follows:</p>
<pre>
  ./configure var_group=wwwrun</pre>
<p>Default values for operating systems other than Cygwin are: <em>var_user=torrus</em>,
<em>var_group=torrus</em>, <em>var_mode=775</em>. Setgid bit is set by default for these
directories.</p>
<p>If available, you may place these directories on a fast media, for example,
a robust disk array. Changing the <code>varprefix</code> variable would be generally
enough, for example:</p>
<pre>
  ./configure varprefix=/vol1/torrus_var</pre>
<p>
</p>
<h2><a name="torrus_directory_layout">Torrus directory layout</a></h2>
<pre>
  /usr/local/torrus/
        Home directory for Torrus distribution files</pre>
<pre>
  /usr/local/torrus/conf_defaults/
        torrus-config.pl and other configuration files</pre>
<pre>
  /usr/local/torrus/bin/
        Command-line executables</pre>
<pre>
  @docdir@/
        POD and TXT documentation files</pre>
<pre>
  /usr/local/torrus/examples/
        Miscelaneous example files</pre>
<pre>
  /usr/local/torrus/perllib/
        Perl libraries</pre>
<pre>
  /usr/local/torrus/plugins/
        Plugins configuration</pre>
<pre>
  /usr/local/torrus/scripts/
        Scripts</pre>
<pre>
  /usr/local/torrus/sup/
        Supplementary files, DTDs, MIBs, color schemas, web plain files</pre>
<pre>
  /usr/local/torrus/templates/
        Renderer output templates</pre>
<pre>
  /usr/local/torrus/xmlconfig/
        Distrubution XML files</pre>
<pre>
  /usr/local/etc/torrus/
        Site configurable files</pre>
<pre>
  /usr/local/etc/torrus/conf/
        Place for torrus-siteconfig.pl and other siteconfigs</pre>
<pre>
  /usr/local/etc/torrus/conf/discovery/
        Devdiscover input files</pre>
<pre>
  /usr/local/etc/torrus/templates/
        User-defined Renderer output templates</pre>
<pre>
  /usr/local/etc/torrus/xmlconfig/
        User XML configuration files</pre>
<pre>
  /usr/local/share/man
        Place for man pages. All articles have the prefix C&lt;torrus_&gt;</pre>
<pre>
  /var/log/torrus/
        Daemon logfiles</pre>
<pre>
  /var/run/torrus
        Daemon PID files</pre>
<pre>
  /var/torrus/cache
        Renderer cache</pre>
<pre>
  /var/torrus/db
        Berkeley DB home</pre>
<pre>
  /var/torrus/session_data/lock
  /var/torrus/session_data/store
        Web interface session files</pre>
<pre>
  /srv/torrus/collector_rrd
        Recommended directory for RRD files generated by collectors</pre>
<p><strong>Note:</strong> RRFW used the path <em>/var/snmpcollector</em> as the default path for
storing the RRD files. According to FHS specification, the recommended
path for service data files is recommended to be a subdirectory of <em>/srv</em>.
The path <em>/srv/torrus/collector_rrd</em> is used as default by <code>torrus genddx</code>
utility, and you can always change it in the command line or in your 
DDX files.</p>
<p>
</p>
<h2><a name="configuring_torrus">Configuring Torrus</a></h2>
<p>The datasources are configured with <code>%Torrus::Global::treeConfig</code>
hash in <em>torrus-siteconfig.pl</em>.</p>
<p>In this hash, the keys give the tree names. The values for each tree name
are pointers to hashes, with the following keys and values:
<em>xmlfiles</em> points to an array of source XML file names;
<em>run</em> points to a hash with the names of the daemons
that would be automatically launched for the tree;
<em>desription</em> gives a short line describing the tree contents.</p>
<p>Two additional arrays: <code>@Torrus::Global::xmlAlwaysIncludeFirst</code> and
<code>@Torrus::Global::xmlAlwaysIncludeLast</code> give a list of source XML
files that are included in every tree, in the beginning or in the end of
the XML files list. By default, this array consists of two files:
<em>defaults.xml</em> and <em>site-global.xml</em>. The second one is resided in
the user-configurable directory, and you can use it to override any
default settings.</p>
<p>Example:</p>
<pre>
  @Torrus::Global::xmlAlwaysIncludeFirst =
      ('defaults.xml', 'site-global.xml');</pre>
<pre>
  %Torrus::Global::treeConfig = (
    'tree_A' =&gt; {
      'description' =&gt; 'The First Tree',
      'xmlfiles' =&gt; [qw(a1.xml a2.xml a3.xml)],
      'run' =&gt; { 'collector' =&gt; 1, 'monitor' =&gt; 1 } },
    'tree_B' =&gt; {
      'description' =&gt; 'The Second Tree',
      'xmlfiles' =&gt; ['b1.xml', 'b2.xml'],
      'run' =&gt; {} }
   );</pre>
<p>XML files are read additively within each tree, in the order
as they are listed. The XML compiler searches for the files in several
directories, listed in <code>@Torrus::Global::xmlDirs</code>. By default, this list
conssists of two paths, one for Torrus distribution files, and the other
for user files.</p>
<p>Files generated by <code>devdiscover</code> usually contain <em>include</em> statements
which add the vendor-specific XML files to the compilation.</p>
<p>Below follows a short description of some XML files that come with
Torrus distribution. Only <em>site-global.xml</em> is installed in the directory 
for user-configurable files, all others are placed in the distribution
directory.</p>
<ul>
<li><strong><a name="item_defaults_2exml">defaults.xml</a></strong><br />
</li>
Default parameters for the root of the datasources tree.
Default view definitions. <strong>Note:</strong> this file is automatically
overwritten by <code>make install</code>.
<p></p>
<li><strong><a name="item_site_2dglobal_2exml">site-global.xml</a></strong><br />
</li>
Parameters that you want to change or define for your site.
This file will be compiled for every tree after <em>defaults.xml</em>,
and this is the place to override the defaults. The file that is supplied
with the Torrus distribution has some useful parameters that you may simply
uncomment.
<strong>Note:</strong> this file is never overwritten by <code>make install</code>.
<p></p>
<li><strong><a name="item_snmp_2ddefs_2exml">snmp-defs.xml</a></strong><br />
</li>
SNMP collector defaults. The file defines several templates
used for collecting SNMP data.
Do not change this file.
You may redefine the needed parameters in your site-specific files
and templates.
<p></p>
<li><strong><a name="item_vendor_2f_3cvendor_3e_2e_3cproduct_3e_5b_2e_3csubs">vendor/&lt;vendor&gt;.&lt;product&gt;[.&lt;subsystem&gt;].xml</a></strong><br />
</li>
SNMP collector definitions and templates for various hardware vendors and
products. <code>devdiscover</code> includes some of these files automatically in the
configuration.
<p></p>
<li><strong><a name="item_generic_2f_2a_2exml">generic/*.xml</a></strong><br />
</li>
SNMP collector definitions and templates for vendor-independent MIBs. Most
files are named after corresponding RFC numbers.
<p></p></ul>
<p>In addition, the distribution package contains several example files.</p>
<p>For more details about XML configuration, see <em>Torrus User Guide</em>
and <em>Torrus XML Configuration Guide</em>.</p>
<p>
</p>
<h2><a name="site_configuration_options">Site configuration options</a></h2>
<p>In addition to <em>%Torrus::Global::treeConfig</em>, you may wish to set
some other parameters in your site configuration file
(<em>torrus-siteconfig.pl</em>).</p>
<p>See <em>torrus-config.pl</em> for the complete list
of varaibes that you may override in your site config. Among them,
most interesting are:</p>
<ul>
<li><strong><a name="item__24torrus_3a_3arenderer_3a_3acompanyname"><code>$Torrus::Renderer::companyName</code></a></strong><br />
</li>
The text that you specify here will appear in the top left corner
of all HTML pages.
<p></p>
<li><strong><a name="item__24torrus_3a_3arenderer_3a_3acompanyurl"><code>$Torrus::Renderer::companyURL</code></a></strong><br />
</li>
The company name text will be clickable with the URL specified in
this variable.
<p></p></ul>
<p>
</p>
<h2><a name="apache_http_server_configuration">Apache HTTP server configuration</a></h2>
<p>Torrus web interface is designed to run under mod_perl environment
(&lt;<a href="http://perl.apache.org">http://perl.apache.org</a>&gt;).</p>
<p>See the <em>Torrus Web Interface Reference</em> document for detailed instructions on
Apache configuration.</p>
<p>In short, typical Apache configuration for mod_perl version 1.0 would look
like follows:</p>
<pre>
  Alias /torrus/plain &quot;/usr/local/torrus/sup/webplain&quot;
  PerlRequire &quot;/usr/local/torrus/conf_defaults/webmux.pl&quot;
  &lt;Location /torrus&gt;
    SetHandler perl-script
    PerlHandler Torrus::ApacheHandler
  &lt;/Location&gt;
  &lt;Location /torrus/plain/&gt;
    SetHandler default-handler
    Options None
  &lt;/Location&gt;</pre>
<p>
</p>
<h2><a name="access_control_lists">Access Control Lists</a></h2>
<p>By default, Torrus web interface requires user authentication.
You can disable this by changing <code>$Torrus::ApacheHandler::authorizeUsers</code>
to zero in your <em>torrus-siteconfig.pl</em>.</p>
<p>ACLs are controlled by <code>acledit</code> utility. See <em>Torrus Manual pages</em>
for detailed description. Example:</p>
<pre>
  torrus acledit --addgroup=staff --permit=DisplayTree --for='*'
  torrus acledit --addgroup=staff --permit=GlobalSearch --for='*'
  torrus acledit --adduser=jsmith --password=mysecretpassword \
    --cn=&quot;John Smith&quot; --addtogroup=staff
  torrus acledit --addgroup=admin \
    --permit=DisplayTree --permit=DisplayAdmInfo --for='*'</pre>
<p>
</p>
<h2><a name="cron_job">Cron Job</a></h2>
<p>In order to clean old HTTP session data, it is recommended to run
<em>cleanup</em> script in a cron job, once per day:</p>
<pre>
 #min hour mday month wday    who     command
 5    3    *    *     *       root    /usr/local/torrus/bin/cleanup</pre>
<p>
</p>
<h2><a name="startup_script">Startup script</a></h2>
<p>The Torrus distriubution provides a startup script which you can install in
the init scripts directory (/etc/init.d on most Unixes or /usr/local/etc/rc.d/
on FreeBSD). The script <code>torrus</code> is created during the installation
process in the subdirectory &lt;init.d&gt; of the distribution directory.</p>
<p>The init script reads some parameters from <em>/usr/local/torrus/conf_defaults/initscript.conf</em>,
and <em>/usr/local/etc/torrus/conf/initscript.siteconf</em> if the latter exists.
By default, it makes the monitor daemons sleep for 20 minutes when
they are launched simultaneously with collector daemons.</p>
<p>
</p>
<h2><a name="upgrade_procedure">Upgrade Procedure</a></h2>
<p>Follow these instructions when upgrading from previous Torrus release.</p>
<p>In the previous distribution directory, look up the <em>config.log</em> file.
It contains the configure options that you used in previous installation.</p>
<p>Unpack the new release distribution.</p>
<p>Run <code>./configure</code> with the same options you used before.</p>
<p>Stop the collector and monitor processes
(usually by <code>/etc/init.d/torrus stop</code>).</p>
<p>Stop Apache process.</p>
<p>Run <code>make install</code>.</p>
<p>Start the collector and monitor processes.</p>
<p>Start Apache process.</p>
<p>Also it is recommended to re-compile your XML configuration.
If you prefer not to do this, it's recommended that you clear the
Web interface cache both in your browser and in Torrus:</p>
<pre>
  torrus clearcache</pre>
<p>
</p>
<h2><a name="planning_the_disk_space">Planning the disk space</a></h2>
<p>In a typical Torrus setup, there are two disk space consuming entities:
the RRDtool data storage and the Berkeley DB database.</p>
<p>RRDtool data files (or RRD's) are used to store the values that are gathered
by the collector daemons. These are the most intensively updated files,
so the disk speed is important here. If possible, it is better to spread
the RRD files across several physical disks.</p>
<p>Berkeley DB database is used to keep all the configuratiuon data
for your datasource trees, and it also keeps some live status information.
It's intensively updated during XML compilation only.
During normal Torrus working cycle, there are only few updates, not
very critical in time. The database is read quite intensively during
collector initialization, but usually it's the CPU speed that causes
more delay.</p>
<p>For a typical Torrus installation with standard RRD creation parameters,
the rough estimation is as follows: the Berkeley DB database occupies
from 10 to 13 KB per collector datasource, and the RRD storage takes
approximately 80 to 85 KB per datasource.</p>
<p>For a medium-sized system, few hundred megabytes for the Berkeley DB database
and several gigabytes for RRD storage would be sufficient. Larger systems
require a thorough design and staging work. See <em>Torrus Scalability Guide</em>
for more details.</p>
<p>
</p>
<h2><a name="network_performance_tuning">Network performance tuning</a></h2>
<p>In large installations, the SNMP collector experiences quite intensive
input traffic bursts. Thus the UDP socket receive buffers should
be adapted to sustain the load. By default, Torrus sets the UDP receiving
buffer size, SO_RCVBUF, to 131071 bytes. This should fit most of
installations. However, it's useful to check the network statistics
if there are any UDP buffer overflows. On most systems, the commands
<code>netstat -s -p udp</code> or <code>netstat -s</code> should show you these counters.
The maximum buffer size is usually limited by a system kernel variable,
and can be increased if needed. See <code>$Torrus::Collector::SNMP::RxBuffer</code>
and its comments in <em>torrus-config.pl</em> for more details.</p>
<p>
</p>
<hr />
<h1><a name="author">Author</a></h1>
<p>Copyright (c) 2002-2007 Stanislav Sinyagin &lt;<a href="mailto:ssinyagin@yahoo.com">ssinyagin@yahoo.com</a>&gt;</p>

</body>

</html>
